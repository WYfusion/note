通道重排（Channel Shuffle）由 **ShuffleNet**（2018, Zhang et al.）提出。

---

## 一、背景：分组卷积的局限

**分组卷积（Group Convolution）** 将通道分成多个组，每组独立卷积，减少计算量。但存在问题：

> **信息隔离**：各组之间无信息交流，限制了特征表达能力。

---

## 二、核心思想

通道重排通过**重新排列通道顺序**，使后续分组卷积能够从不同组获取信息，打破组间隔离。

---

## 三、操作流程

设输入特征图通道数为 $C$，分为 $g$ 组：

### 3.1 数学描述

1. **Reshape**：$(B, C, H, W) \to (B, g, C/g, H, W)$
2. **Transpose**：交换第 1、2 维 → $(B, C/g, g, H, W)$
3. **Flatten**：$(B, C/g, g, H, W) \to (B, C, H, W)$

### 3.2 PyTorch 实现

```python
def channel_shuffle(x, groups):
    B, C, H, W = x.shape
    # reshape: (B, C, H, W) -> (B, g, C/g, H, W)
    x = x.view(B, groups, C // groups, H, W)
    # transpose: (B, g, C/g, H, W) -> (B, C/g, g, H, W)
    x = x.transpose(1, 2).contiguous()
    # flatten: (B, C/g, g, H, W) -> (B, C, H, W)
    x = x.view(B, C, H, W)
    return x
```

---

## 四、示意图解析 ^a2e53a

![通道重排示意图](image-20241113220113044.png)

| **图示** | **说明**                                               |
| -------- | ------------------------------------------------------ |
| **(a)**  | 两个**分组数相同**的分组卷积堆叠，组间无信息交流       |
| **(b)**  | GConv2 从 GConv1 的**不同输出组**中获取数据            |
| **(c)**  | (b) 经过通道重排后的**等价形式**，实现跨组信息融合     |

---

## 五、效果与优势

| **优势**           | **说明**                                   |
| ------------------ | ------------------------------------------ |
| **跨组信息融合**   | 打破分组卷积的信息隔离                     |
| **零参数开销**     | 仅改变通道顺序，无额外参数                 |
| **计算高效**       | 仅涉及内存重排，计算成本极低               |
| **与分组卷积互补** | 结合使用可在保持效率的同时增强表达能力     |
