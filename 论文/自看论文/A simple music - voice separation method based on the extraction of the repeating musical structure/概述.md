[基于提取重复音乐结构的简单音乐/语音分离方法 | IEEE 会议出版物 | IEEE Xplore --- A simple music/voice separation method based on the extraction of the repeating musical structure | IEEE Conference Publication | IEEE Xplore](https://ieeexplore.ieee.org/document/5946380)
本文提出的音乐 / 语音分离方法基于信号自相似性和时频分析，核心数学原理可分为**重复周期估计**、**重复段模型构建**和**二进制时频掩蔽**三部分，以下从数学角度详细解析其原理：

### 一、重复周期估计：基于自相关的节拍谱计算
#### 1. 频谱图与能量平方预处理
- **短时傅里叶变换（STFT）**： 对混合信号 $x(t)$ 加汉明窗 w(t) 分帧，计算幅度谱 $V(i, j) = |X(i, j)|$，其中 $i$ 为频率索引$i=1,\dots,n，n=N/2+1，N$为窗长），$j$ 为时间帧索引（$j=1,\dots,m$）。 **能量平方处理**：使用 $V^2$ 而非 $V$，因平方运算放大高能量区域的贡献，增强周期性峰值的显著性（能量越大，重复模式越易检测）。
#### 2. 自相关矩阵与节拍谱生成
- **频率分量自相关**： 对每个频率 $i$，计算延迟 $j$ 下的自相关 $B(i, j)$，即相邻 $j$ 帧的能量乘积平均：$B(i, j) = \frac{1}{m-j+1} \sum_{k=1}^{m-j+1} V(i, k)^2 V(i, k+j-1)^2$ 物理意义：衡量频率 $i$ 在时间延迟 $j$ 时的能量相似性，值越大表示该频率在 $j$ 帧前后的能量模式越一致。
- **全局自相似性向量 b**： 对所有频率的自相关求平均，得到整体节拍谱 $b(j)$，反映信号全局周期性：$b(j) = \frac{1}{n} \sum\limits_{i=1}^{n} B(i, j)$归一化处理：$b(j)$ 除以 $b(1)$（延迟 $1$ 帧的自相关），消除幅度影响，突出相对周期性。
#### 3. 周期 p 的确定
忽略 $j=0$（自身完全相似），寻找 $b(j)$ 中**周期性最强、峰值能量最高**的延迟 $p$，即通过检测局部极大值及其重复频率，确定音乐结构的最长重复周期（如主歌 - 副歌循环）。
### 二、重复段模型：几何平均增强模式一致性
#### 1. 频谱图分段
- 将频谱图按周期 $p$ 划分为 $r = \lfloor m/p \rfloor$ 个等长段，每段时间范围为 $[l + (k-1)p, l + kp]$，其中 $l=1,\dots,p$ 为段内时间点，$k=1,\dots,r$ 为段索引。
#### 2. 几何平均建模

- 对每个频率 $i$ 和段内时间点 $l$，计算 $r$ 个段的几何平均 $\bar{V}(i, l)：\bar{V}(i, l) = \left( \prod\limits_{k=1}^{r} V(i, l + (k-1)p) \right)^{\frac{1}{r}} = \exp\left( \frac{1}{r} \sum\limits_{k=1}^{r} \log V(i, l + (k-1)p) \right)$ **选择几何平均的原因**：
    - 当重复段存在幅度缩放（如音量变化）时，几何平均对乘法性变化不敏感（算术平均会受幅度差异影响，而几何平均在对数域等价于加法平均，保持模式形状一致）。
    - 抑制异常值：若某段突发噪声（非重复结构），其对数可能为极大值或极小值，几何平均通过指数运算削弱其影响，而算术平均会被噪声拉高或压低。
### 三、二进制时频掩蔽：对数差异度量与阈值分割
#### 1. 时频单元差异计算
- 对每个时频单元 $(i, j)$，计算其与重复段模型 $\bar{V}(i, l)$（$l = j \mod p$，即对应段内时间点）的对数绝对值差异 $\tilde{V}(i, j)：\tilde{V}(i, j) = \left| \log \left( \frac{V(i, j)}{\bar{V}(i, l)} \right) \right| = \left| \log V(i, j) - \log \bar{V}(i, l) \right|$ **数学意义**：
    - 对数变换将除法转为减法，压缩动态范围（高频小幅度和低频大幅度的差异在对数域更均衡）。
    - 绝对值确保差异非负，值越小表示 V(i, j) 与模型越接近（属于重复音乐结构），值越大表示差异越大（可能为变化的语音）。
#### 2. 二进制掩蔽生成
设置容差阈值 $t=1$（实验优化值），若 $\tilde{V}(i, j) \leq t$，判定为重复音乐（$M(i, j)=1$），否则为语音$$(M(i, j)=0)：M(i, j) = \begin{cases} 1 & \text{重复音乐（时频单元与模型一致）} \\ 0 & \text{语音（时频单元显著变化）} \end{cases}$$**阈值逻辑**：允许一定程度的差异（如音乐轻微变调或演奏差异），$t=1$ 平衡了漏检（误判语音为音乐）和错检（误判音乐为语音）。
#### 3. 信号重构
对 STFT 复数域信号 $X(i, j)$ 应用掩蔽 M，分离音乐和语音的时频表示：$\begin{cases} \hat{X}_{\text{music}}(i, j) = M(i, j) \cdot X(i, j) \\ \hat{X}_{\text{voice}}(i, j) = (1 - M(i, j)) \cdot X(i, j) \end{cases}$逆 STFT 后得到时域信号 $\hat{x}_{\text{music}} 和 \hat{x}_{\text{voice}}$。
### 四、核心数学假设与创新点
1. **重复结构的时频稀疏性**： 假设音乐伴奏的时频单元在周期 p 内重复出现（$V(i, j) \approx \bar{V}(i, l)$），而语音因歌词变化，时频单元与模型差异显著（$\tilde{V}(i, j) > t$）。通过对数差异度量，将这一假设转化为可计算的数学条件。
2. **几何平均的不变性**： 针对音乐重复段可能存在的幅度缩放（如音量起伏），几何平均在对数域的加法特性，使其对乘性噪声（如增益变化）具有鲁棒性，优于易受幅度影响的算术平均。
3. **无参数依赖的通用性**： 仅依赖信号自相似性（自相关和几何平均），无需训练数据或先验特征（如 MFCC、音高），数学推导简洁，计算复杂度低（主要为 STFT、自相关和逐点运算）。

### 五、数学公式总结与逻辑链
$\text{混合信号} \xrightarrow{\text{STFT}} V(i,j) \xrightarrow{V^2 \text{自相关}} B(i,j) \xrightarrow{\text{频率平均}} b(j) \xrightarrow{\text{峰值检测}} p \\ V(i,j) \xrightarrow{\text{按 } p \text{ 分段}} \text{几何平均} \bar{V}(i,l) \xrightarrow{\text{对数差异}} \tilde{V}(i,j) \xrightarrow{\text{阈值} t} M(i,j) \xrightarrow{\text{掩蔽}} \hat{X}_{\text{music/voice}}$

通过上述数学步骤，将 “音乐重复、语音变化” 的物理现象转化为可计算的时频掩蔽，实现了无需先验知识的盲分离，在效率和性能上优于传统方法。