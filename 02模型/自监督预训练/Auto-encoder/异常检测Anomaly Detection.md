简单的理解异常检测无非是将正常的和异常的进行一个分类即可，也就是一个二分类问题。但是常规情况下大多数所采集到的数据都是正常的，很少有异常数据，因此常常认为只有一种类别的数据。这样会导致常规二分类问题所需要两个类别才可以训练的前提无法实现。因此就需要使用[[Auto-encoder]]的技术。

### **一、原理与核心思想**

1. **重构误差作为异常指标** Auto-encoder通过编码器（Encoder）将输入数据压缩为低维潜在表示，再通过解码器（Decoder）重构原始数据。正常数据因符合训练集的分布特征，重构误差（如均方误差MSE）较低；而异常数据因偏离正常模式，重构误差显著升高。通过设定阈值，可将高于阈值的样本判定为异常。
2. **基于密度估计的异常判定** 在变分自编码器（VAE）中，异常检测可通过计算测试数据的“重构概率”（即数据在潜在分布中的概率密度）实现。正常数据在潜在空间中的分布密度较高，异常数据则密度较低。
### **二、实现步骤与关键技术**
1. **数据预处理**
    - **归一化/标准化**：消除量纲差异，例如使用`StandardScaler`或`MinMaxScaler`对数据进行缩放。
    - **时序数据分段**：针对时间序列异常检测，需将数据划分为固定长度的窗口（如滑动窗口），捕捉局部特征。
2. **模型构建与训练**
    - **网络结构**：编码器和解码器通常由全连接层或卷积层构成。例如，编码器将输入压缩至低维空间（如4维），解码器尝试重构输入。
    - **损失函数**：常用MSE衡量重构误差。对于VAE，需结合重构损失与KL散度，约束潜在分布的正态性。
    - **训练策略**：仅使用正常数据训练模型，确保模型对正常模式敏感。
3. **异常判定与阈值设定**
    - **误差分布分析**：计算训练集的重构误差分布（如高斯分布），设定阈值（如μ+3σ）作为异常判定依据。
    - **动态阈值调整**：根据业务需求调整阈值，平衡误报率与漏报率。