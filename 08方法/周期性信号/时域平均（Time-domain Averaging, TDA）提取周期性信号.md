#### 一、时域平均的基本概念与应用背景

时域平均是信号处理中一种经典的降噪技术，核心思想是通过对**周期性信号**的多个周期进行对齐和平均，抑制随机噪声的影响。其典型应用包括机械故障诊断（如振动信号分析）、生物医学信号处理（如脑电 / 心电信号提取）等。当目标信号具有确定性周期成分，而噪声为随机过程时，时域平均能显著提升信噪比（SNR）。

#### 二、数学模型与原理分析

##### 1. 信号模型构建

设原始信号为：
$x(t) = s(t) + n(t), \quad t \in \mathbb{R}$
其中： 
- $s(t)$ 为周期为 T 的确定性信号，即 $s(t + kT) = s(t)$，$\forall k \in \mathbb{Z}$；
- $n(t)$ 为随机噪声，满足平稳性假设（均值为零，方差有限）。

##### 2. 时域平均操作定义

对 N 个周期的信号进行时域平均，操作如下：  
$\bar{x}_N(t) = \frac{1}{N} \sum_\limits{m=0}^{N-1} x(t + mT), \quad t \in [0, T)$
将信号模型代入得：
$\bar{x}_N(t) = \frac{1}{N} \sum_\limits{m=0}^{N-1} [s(t + mT) + n(t + mT)] = s(t) + \frac{1}{N} \sum_\limits{m=0}^{N-1} n(t + mT)$
上式中，$s(t + mT) = s(t)$ 由周期性直接得出，因此信号部分在平均后完全保留，而噪声部分被平均处理。

##### 3. 噪声抑制的数学证明

**步骤 1：噪声的均值分析** 设噪声 $n(t)$ 为零均值平稳过程，即 $\mathbb{E}[n(t)] = 0$，则平均后噪声部分的期望为：
$\mathbb{E}\left[\frac{1}{N} \sum_\limits{m=0}^{N-1} n(t + mT)\right] = \frac{1}{N} \sum_\limits{m=0}^{N-1} \mathbb{E}[n(t + mT)] = 0$
即噪声的均值在平均后仍为零，不影响信号的直流分量。

**步骤 2：噪声的方差分析** 设噪声的自协方差函数为 $R_n(\tau) = \mathbb{E}[n(t)n(t+\tau)]$，则平均后噪声部分的方差为：
$\operatorname{Var}\left[\frac{1}{N} \sum_\limits{m=0}^{N-1} n(t + mT)\right] = \frac{1}{N^2} \sum_\limits{m=0}^{N-1} \sum_\limits{k=0}^{N-1} R_n((m-k)T)$
若噪声在不同周期上**不相关**（即当 $m \neq k$ 时，$R_n((m-k)T) = 0$），则上式简化为：
$\operatorname{Var}[\cdot] = \frac{1}{N^2} \sum_\limits{m=0}^{N-1} R_n(0) = \frac{R_n(0)}{N}$
其中 $R_n(0) = \operatorname{Var}[n(t)]$ 为单周期噪声方差。可见，噪声方差随 N 增大呈 $1/N$ 衰减，即：
$\operatorname{Var}[\bar{x}_N(t) - s(t)] = \frac{\sigma_n^2}{N}, \quad \sigma_n^2 = \operatorname{Var}[n(t)]$
**步骤 3：信噪比提升证明** 原始信号的信噪比为：
$\mathrm{SNR}_\text{原始} = \frac{\mathbb{E}[s(t)^2]}{\sigma_n^2}$
平均后信号的信噪比为：
$\mathrm{SNR}_N = \frac{\mathbb{E}[s(t)^2]}{\sigma_n^2 / N} = N \cdot \mathrm{SNR}_\text{原始}$
这表明时域平均可使信噪比**线性提升**，即 N 次平均后，信噪比提升 N 倍。此结论可通过**大数定律**严格推导：当 $N \to \infty$ 时，噪声部分依概率收敛于零，即：$\bar{x}_N(t) \xrightarrow[]{P} s(t)$
#### 三、离散时间场景下的严格推导
考虑离散时间信号 $x[n] = s[n] + n[n]$，其中 $s[n+K] = s[n]$（K 为周期点数），对 N 个周期平均：

$\bar{x}_N[n] = \frac{1}{N} \sum_\limits{m=0}^{N-1} x[n + mK], \quad n \in [0, K-1]$
同样分解为：
$\bar{x}_N[n] = s[n] + \frac{1}{N} \sum_\limits{m=0}^{N-1} n[n + mK]$
若噪声 $n[n]$ 为零均值白噪声（$\mathbb{E}[n[n]n[n+l]] = \sigma_n^2 \delta[l]$），则平均后噪声方差为：
$\operatorname{Var}\left[\frac{1}{N} \sum_\limits{m=0}^{N-1} n[n + mK]\right] = \frac{1}{N^2} \sum_\limits{m=0}^{N-1} \sum_\limits{k=0}^{N-1} \sigma_n^2 \delta[(m-k)K] = \frac{\sigma_n^2}{N}$
与连续时间结论一致，证明了时域平均对离散周期信号的降噪有效性。

#### 四、关键假设与实际限制

1. **周期精确已知**：需预先确定周期 T 或 K，若周期估计存在误差（如频率偏移），会导致信号对齐错误，降低降噪效果。
2. **噪声统计特性**：上述证明依赖噪声的零均值和平稳性假设，若噪声包含周期性成分（如工频干扰），时域平均无法抑制此类噪声。
3. **计算复杂度**：随平均次数 N 增加，计算量线性增长，实时性应用中需权衡降噪效果与计算成本。

#### 五、扩展：与其他降噪方法的对比

- **与频域滤波的区别**：时域平均直接利用信号周期性，无需频域变换，对非平稳噪声适应性更强；频域滤波依赖频谱分辨率，可能丢失时域细节。
- **与小波降噪的结合**：实际应用中常结合小波变换，先通过时域平均抑制随机噪声，再利用小波处理非周期暂态成分，提升复杂信号的提取效果。

#### 六、结论

时域平均通过 “周期性信号不变性” 与 “随机噪声可平均性” 的本质差异，实现信噪比的线性提升。其数学本质是利用概率论中的大数定律，将噪声的方差随平均次数 N 降至 $1/N$，而确定性周期信号完全保留。该方法原理简洁、计算高效，是提取低信噪比周期信号的基础技术，广泛应用于工程实践与科学研究中。