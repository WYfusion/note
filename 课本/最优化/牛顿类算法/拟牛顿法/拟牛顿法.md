![[Pasted image 20250610140114.png|800]]
![[Pasted image 20250610140126.png|800]]
### 拟牛顿法的设计思路与数学推导
#### 1. 核心思想：近似海瑟矩阵与拟牛顿条件
牛顿法的迭代方向为 $d^k = -H_k^{-1} \nabla f(x^k)$，其中 $H_k = \nabla^2 f(x^k)$。拟牛顿法通过 **近似矩阵 $B^k \approx H_k$ 或 $H^k \approx H_k^{-1}$** 避免直接计算 $H_k$，并满足 **拟牛顿条件**：
- 若近似海瑟矩阵 $B^k$，则 $B^{k+1} s^k = y^k$（$s^k = x^{k+1}-x^k$，$y^k = \nabla f(x^{k+1})-\nabla f(x^k)$）。
- 若近似逆海瑟矩阵 $H^k$，则 $H^{k+1} y^k = s^k$。
该条件源于二次函数的性质：对 $f(x) = \frac{1}{2}x^T H x + b^T x + c$，有 $H s^k = y^k$，拟牛顿法模拟此关系，确保近似矩阵在二次情形下精确恢复 H，保留牛顿法的二阶收敛性。
#### 2. 迭代更新公式（以 BFGS 为例，更新逆海瑟矩阵）
BFGS 更新公式为：$H^{k+1} = \left(I - \frac{s^k y^{kT}}{y^{kT} s^k}\right) H^k \left(I - \frac{y^k s^{kT}}{y^{kT} s^k}\right) + \frac{s^k s^{kT}}{y^{kT} s^k}$ **拟牛顿条件验证**： 计算 $H^{k+1} y^k$，利用 $y^{kT} s^k = s^{kT} y^k \equiv \sigma_k$，得：$H^{k+1} y^k = 0 + \frac{s^k \sigma_k}{\sigma_k} = s^k$ 满足 $H^{k+1} y^k = s^k$，且 $H^{k+1}$ 对称（因海瑟矩阵对称，近似矩阵也保持对称）。
#### 3. 算法框架与线搜索
- **初始化**：$x^0$，初始 $H^0$（如单位矩阵）。
- **迭代步骤**：
    1. **方向计算**：$d^k = -H^k \nabla f(x^k)$（下降方向，因 $d^{k\top} \nabla f(x^k) = -\nabla f(x^k)^\top H^k \nabla f(x^k) \leq 0$，假设 $H^k$ 正定，线搜索保证下降）。
    2. **线搜索**：通过 Wolfe 条件（$f(x^k + \alpha_k d^k) \leq f(x^k) + c_1 \alpha_k \nabla f(x^k)^\top d^k$，$|\nabla f(x^k + \alpha_k d^k)^\top d^k| \leq c_2 |\nabla f(x^k)^\top d^k|$，$0 < c_1 < c_2 < 1$）确定步长 $\alpha_k$，更新 $x^{k+1}$。
    3. **更新近似矩阵**：用 BFGS 公式更新 $H^{k+1}$。
#### 4. 收敛性证明
- **全局收敛**（Zoutendijk 定理）： 线搜索保证 $\sum_\limits{k=0}^\infty (\nabla f(x^k)^T d^k)^2 / \|d^k\|^2 < \infty$，结合 $d^k$ 为下降方向，得 $\|\nabla f(x^k)\| \to 0$。
- **局部超线性收敛**： 当 $x^k \to x^*$（极小点，$H^* = \nabla^2 f(x^*)$ 正定），拟牛顿条件 $H^{k+1} y^k = s^k$ 与 $H^* s^k \approx y^k$（泰勒展开）结合，证明 $H^k \to (H^*)^{-1}$，故迭代方向 $d^k \to - (H^*)^{-1} \nabla f(x^*) = 0$（因 $\nabla f(x^*)=0$），实际推导中通过误差分析得收敛速度超线性。
#### 5. **应用场景**
- **大规模优化**：如逻辑回归（海瑟矩阵稀疏，拟牛顿法避免存储完整矩阵）、神经网络训练（Hessian-free 优化，结合拟牛顿思想的优化器如 L-BFGS）。
- **海瑟矩阵难以解析**：目标函数可微但海瑟矩阵无显式表达式，通过梯度差 $y^k$ 和步长 $s^k$ 隐式更新近似矩阵。
### 数学推导总结
拟牛顿法通过 **拟牛顿条件** 递推更新海瑟矩阵的近似（或其逆），利用二次函数的性质保证局部快速收敛，结合线搜索确保全局收敛。以 BFGS 为例，其更新公式严格满足拟牛顿条件，且在理论上证明了收敛性，成为求解无约束优化问题的高效算法，尤其适用于海瑟矩阵计算 / 存储成本高的场景。