![[Pasted image 20250608213837.png|800]]
![[Pasted image 20250608213842.png|800]]
- **凸问题**（如线性规划、二次规划）中，**KKT 点即为最优解**。
- **非凸问题**（如非线性规划）中，**KKT 点可能为局部最优或鞍点**（需通过二阶 Hessian 矩阵判断正定性）。
### Karush-Kuhn-Tucker (KKT) 条件详解
#### 1. 定义与问题描述
考虑带约束的非线性优化问题（NLPs）：
$\begin{cases} \min\ f(x) \\ \text{s.t.}\ g_i(x) \leq 0\ (i=1,\dots,m),\ h_j(x) = 0\ (j=1,\dots,p), \end{cases}$
其中 $f, g_i, h_j$ 可微。KKT 条件是该问题局部最优解 $x^*$ 的一阶必要条件，由拉格朗日函数 $L(x, \lambda, \mu) = f(x) + \sum \lambda_i g_i(x) + \sum \mu_j h_j(x)$（$\lambda \geq 0$）导出。
#### 2. KKT 条件的组成（必要条件）
1. **梯度条件（驻点条件）**：
    $$\nabla_x L(x^*, \lambda^*, \mu^*) = \nabla f(x^*) + \sum_\limits{i=1}^m \lambda_i^* \nabla g_i(x^*) + \sum_\limits{j=1}^p \mu_j^* \nabla h_j(x^*) = 0.$$
    （目标与约束梯度线性组合为零，类似拉格朗日乘子法的推广，确保无改进方向）
2. **原始可行性条件**：
    $$g_i(x^*) \leq 0\ (\forall i),\ \ h_j(x^*) = 0\ (\forall j).$$
    （解满足原始约束）
3. **对偶可行性条件**：
    $$\lambda_i^* \geq 0\ (\forall i).$$
    （不等式约束的对偶变量非负，对应 “惩罚” 权重非负）
4. **互补松弛条件**：
    $$\lambda_i^* g_i(x^*) = 0\ (\forall i).$$
- 紧约束（$\lambda_i > 0$） ⇨ $g_i(x) = 0$（约束生效，无松弛）；
- 松约束（$g_i(x) < 0$） ⇨ $\lambda_i = 0$（约束无效，乘子为零）。
###### 核心作用
- **约束有效性判定**：直接区分最优解处哪些不等式约束是 “紧” 的（起作用），哪些是 “松” 的（可忽略）。例如，在资源分配中，若某资源未用尽（松约束，$g_i < 0$），其影子价格 $\lambda_i = 0$（增加该资源不影响目标）；若用尽（紧约束，$g_i = 0$），影子价格 $\lambda_i > 0$（资源稀缺，需支付成本）。
- **降维简化计算**：求解时只需处理紧约束（$\lambda_i > 0$ 对应 $g_i = 0$），松约束（$\lambda_i = 0$）可从优化模型中移除，减少变量和约束数量。如线性规划单纯形法中，基变量对应紧约束（等式约束，类似推广），非基变量对应松约束（$\lambda_i = 0$）。
- **对偶性保证**：在凸优化的强对偶性（如 Slater 条件下）中，互补松弛是原始与对偶解一致性的必要条件。它确保乘子 $\lambda_i$ 与约束 $g_i$ 不能同时为正（避免矛盾：若 $\lambda_i > 0$ 且 $g_i < 0$，可通过松弛约束降低目标，与最优性矛盾）。
###### 例子
- **SVM（凸优化）**：支持向量对应紧约束（$\lambda_i > 0$，$g_i(x) = 0$），决定分类超平面；非支持向量对应松约束（$\lambda_i = 0$，$g_i(x) < 0$），不影响超平面。互补松弛直接识别关键样本，简化模型。
#### 3. 严谨推导（以单个不等式约束为例）
- **松约束（$g(x^*) < 0$）**：此时局部最优等价于无约束优化，故 $\nabla f(x^*) = 0$，且 $\lambda^* = 0$（满足互补松弛）。
- **紧约束（$g(x^*) = 0$）**：问题退化为等式约束 $g(x)=0$，拉格朗日乘子法得 $\nabla f(x^*) + \lambda^* \nabla g(x^*) = 0$，且 $\lambda^* \geq 0$（因约束是 “≤”，对偶变量非负，避免负权重导致矛盾）。
推广到多约束，等式约束的 $\mu_j$ 无符号限制（因等式是双向约束），不等式约束的 $\lambda_i \geq 0$，结合互补松弛，形成完整 KKT 条件。
#### 4. 几何与通俗解释
- **梯度平衡**：最优解处，目标函数的梯度被约束梯度 “抵消”（线性组合为零），即无法沿可行方向降低目标。
- **互补松弛**：不等式约束如 “开关”，紧时（$\lambda_i^*>0$）必须满足 $g_i=0$（用 “成本”$\lambda_i$ 维持约束），松时（$\lambda_i^*=0$）无需成本，约束可忽略。
- **对偶非负性**：保证不等式约束的 “惩罚” 不会反向（否则可通过增加松弛降低目标，与最优性矛盾）。
#### 5. 充分性（凸优化情形）
**若 $f$ 凸，$g_i$ 凸（不等式约束），$h_j$ 线性（等式约束），则 KKT 条件也是充分条件**：满足 KKT 的点 $x^*$ 是全局最优解。例如，SVM 的凸二次规划问题，KKT 条件直接给出最优解。
#### 6. 应用与求解
KKT 条件将约束优化转化为方程组（梯度 + 互补松弛 + 可行性），通过数值方法（如内点法、SQP）求解。对于凸问题，解唯一且全局最优；非凸问题中，KKT 点需验证是否为局部最优。
### 总结公式
对优化问题
$$\begin{cases} \min\ f(x) \\ g_i(x) \leq 0,\ h_j(x)=0, \end{cases}$$
KKT 条件为：
$$\left\{ \begin{aligned} &\nabla f + \sum\lambda_i \nabla g_i + \sum\mu_j \nabla h_j = 0, \\ &g_i \leq 0,\ h_j = 0, \\ &\lambda_i \geq 0, \\ &\lambda_i g_i = 0, \end{aligned} \right.$$
其中 $\lambda \in \mathbb{R}^m_+$，$\mu \in \mathbb{R}^p$。
### 示例：凸优化中的 KKT 应用（如 SVM）
SVM 的优化问题为凸二次规划，KKT 条件确保：
- 支持向量（紧约束，$\lambda_i^*>0$）决定分类超平面；
- 非支持向量（松约束，$\lambda_i^*=0$）不影响超平面。 通过求解 KKT 方程组，直接得到最优分类器参数，体现其在凸优化中的核心作用。
### 结论
KKT 条件是约束优化的核心理论，统一处理等式与不等式约束，为数值求解和理论分析提供基础。在凸优化中，其既是必要条件也是充分条件，广泛应用于机器学习、运筹学等领域，是连接理论与算法的关键桥梁。