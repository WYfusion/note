# 自适应波束形成 (Adaptive Beamforming)

固定波束形成（如DSB）的权重仅取决于预设的目标方向，无法适应动态变化的噪声环境。为了克服这一局限性，**自适应波束形成**被提出来，它能够利用信号的**统计特性**来动态地计算最优滤波器权重，从而在保持目标信号的同时，最大程度地抑制噪声和干扰。

## 1. 最小方差无失真响应 (MVDR) 波束形成器

MVDR (Minimum Variance Distortionless Response) 是最经典、最著名的自适应波束形成算法。它的优化目标非常直观：

1.  **无失真响应 (Distortionless Response)**: 保证来自目标方向的信号分量不产生任何失真。
2.  **最小方差 (Minimum Variance)**: 最小化波束形成器输出信号的**总功率（方差）**。

由于目标信号无失真，最小化总输出功率就等价于**最小化输出的噪声和干扰功率**。

### MVDR 的数学描述

假设我们已知目标信号的**导向矢量 (Steering Vector)** $\mathbf{d}(f)$。这个矢量代表了目标信号在麦克风阵列上的传递函数。

MVDR 的优化问题可以写成一个约束优化问题：

$$
\min_{\mathbf{w}(f)} \quad E\{ |\hat{S}(f, t)|^2 \} \quad \text{subject to} \quad \mathbf{w}^H(f) \mathbf{d}(f) = 1
$$

- **目标函数**: $E\{ |\hat{S}(f, t)|^2 \} = E\{ |\mathbf{w}^H(f) \mathbf{X}(f, t)|^2 \} = \mathbf{w}^H(f) \mathbf{\Phi}_{xx}(f) \mathbf{w}(f)$。其中 $\mathbf{\Phi}_{xx}(f) = E\{ \mathbf{X}(f, t) \mathbf{X}^H(f, t) \}$ 是输入信号的**空间相关矩阵 (SCM)**。
- **约束条件**: $\mathbf{w}^H(f) \mathbf{d}(f) = 1$ 确保了目标信号的增益为1，即无失真。

### MVDR 解

这个带约束的优化问题可以通过拉格朗日乘子法 [[拉格朗日对偶问题求解流程]] 求解，得到其闭式解：

$$
\mathbf{w}_{mvdr}(f) = \frac{\mathbf{\Phi}_{nn}^{-1}(f) \mathbf{d}(f)}{\mathbf{d}^H(f) \mathbf{\Phi}_{nn}^{-1}(f) \mathbf{d}(f)}
$$

这里的 $\mathbf{\Phi}_{nn}(f)$ 是**噪声的空间相关矩阵**。在推导中，通常假设信号与噪声不相关，此时 $\mathbf{\Phi}_{xx}(f) = \mathbf{\Phi}_{ss}(f) + \mathbf{\Phi}_{nn}(f)$。在最小化过程中，信号部分的功率是固定的，因此最小化 $\mathbf{w}^H \mathbf{\Phi}_{xx} \mathbf{w}$ 等价于最小化 $\mathbf{w}^H \mathbf{\Phi}_{nn} \mathbf{w}$。所以最终的解中出现了噪声的SCM $\mathbf{\Phi}_{nn}(f)$。

**分母**是一个标量，用于归一化，确保满足无失真约束。因此，MVDR 权重的核心在于分子：$\mathbf{\Phi}_{nn}^{-1}(f) \mathbf{d}(f)$。

**直观理解**:
- $\mathbf{d}(f)$ 负责将波束对准目标方向。
- $\mathbf{\Phi}_{nn}^{-1}(f)$ 负责对噪声进行“白化”，即在噪声能量强的空间方向上施加更小的权重，从而形成零陷来抑制噪声。

**挑战**: 在实践中，我们无法直接得到纯净噪声的SCM $\mathbf{\Phi}_{nn}(f)$ 和精确的导向矢量 $\mathbf{d}(f)$。因此，如何**准确估计**这两个量是MVDR成功的关键。

## 2. 广义旁瓣对消器 (Generalized Sidelobe Canceller, GSC)

GSC 是 MVDR 的一种等效实现结构，它将复杂的复数优化问题分解为一系列的实数自适应滤波问题，更便于理解和实现。

GSC 结构包含三个主要部分：

![GSC Structure](https://www.researchgate.net/profile/Israel-Cohen/publication/224218730/figure/fig1/AS:393802955255810@1470901235398/Block-diagram-of-the-generalized-sidelobe-canceller-GSC.png)

1.  **上支路：固定波束形成器 (Fixed Beamformer)**
    - 这是一个简单的 Delay-and-Sum 波束形成器，其权重为 $\mathbf{w}_q = \mathbf{d} / (\mathbf{d}^H \mathbf{d})$，用于在目标方向上形成一个主瓣，得到一个初步增强的信号 $y_q(t)$。此路保证了目标信号能够无失真地通过。

2.  **下支路：阻塞矩阵 (Blocking Matrix)**
    - 阻塞矩阵 $\mathbf{B}$ 的作用是**完全阻塞**来自目标方向的信号，只让噪声和干扰通过。
    - $\mathbf{B}$ 必须满足 $\mathbf{B}^H \mathbf{d} = \mathbf{0}$。
    - 它的输出是一个多通道信号，理想情况下只包含噪声和干扰成分。

3.  **自适应对消器 (Adaptive Canceller)**
    - 下支路输出的噪声参考信号被送入一个多通道自适应滤波器（如 NLMS）。
    - 该滤波器调整权重 $\mathbf{w}_a$，使其输出 $y_a(t)$ 尽可能地逼近上支路信号 $y_q(t)$ 中残留的噪声成分。
    - 最后，从上支路信号中减去这个估计出的噪声，得到最终的增强信号 $e(t) = y_q(t) - y_a(t)$。

**GSC的优势**:
- 将约束优化问题转化为非约束的自适应问题。
- 结构清晰，上路保信号，下路提噪声，最后做相减。
- 但是，GSC 对导向矢量的误差非常敏感。如果 $\mathbf{d}(f)$ 估计不准，目标信号会泄露到下支路，导致自适应对消器将部分目标信号也一并消除，造成**目标信号抵消 (Target Signal Cancellation)**。

无论是直接求解 MVDR 还是使用 GSC 结构，准确估计信号统计信息（SCM）和目标导向矢量都是实现高性能自适应波束形成的核心挑战。
