# 盲源分离 (Blind Source Separation, BSS)

> 📚 **详细内容**：本文件是BSS的概述，更详细的算法原理和数学推导请参见 [[BSS/00_BSS概述与目录|BSS专题文件夹]]，包含：
> - 经典算法：ICA、FastICA、JADE、IVA、AuxIVA、ILRMA
> - 深度学习方法：TasNet、Conv-TasNet、Dual-Path RNN、SepFormer

盲源分离（BSS）是指在只知道混合信号（如多个麦克风的录音），而对声源信号本身以及信号的混合方式（如房间冲激响应）知之甚少（"盲"）的情况下，分离出各个独立的原始声源信号的一类技术。

"鸡尾酒会问题" (Cocktail Party Problem) 是对BSS任务最形象的描述：我们能否设计一个系统，使其在嘈杂的、多人同时说话的派对中，只听清其中一个人的讲话？

## 1. BSS 数学模型

假设有 $N$ 个独立的声源信号 $\mathbf{s}(t) = [s_1(t), \dots, s_N(t)]^T$，被 $P$ 个麦克风采集。在时域中，混合过程是卷积：

$$\mathbf{x}(t) = \mathbf{A}(t) * \mathbf{s}(t)$$

其中 $\mathbf{x}(t)$ 是 $P \times 1$ 的观测信号向量，$\mathbf{A}(t)$ 是一个 $P \times N$ 的矩阵，其元素 $a_{ij}(t)$ 是从第 $j$ 个声源到第 $i$ 个麦克风的声学冲激响应。这种复杂的卷积混合在BSS中被称为**卷积混合模型**。

为了简化问题，我们通常在频域中处理。通过STFT，模型变为：

$$\mathbf{X}(f, t) = \mathbf{A}(f) \mathbf{S}(f, t)$$

其中 $\mathbf{A}(f)$ 是混合矩阵。在每个频率点 $f$，这都是一个**瞬时混合模型**（线性代数混合）。BSS的目标是找到一个**解混矩阵 (Unmixing Matrix)** $\mathbf{W}(f)$，使得：

$$\hat{\mathbf{S}}(f, t) = \mathbf{W}(f) \mathbf{X}(f, t)$$

其中 $\hat{\mathbf{S}}(f, t)$ 是对原始声源信号 $\mathbf{S}(f, t)$ 的估计。理想情况下，$\mathbf{W}(f) = \mathbf{A}^{-1}(f)$。

## 2. 独立成分分析 (Independent Component Analysis, ICA)

> 详见：[[BSS/02_ICA独立成分分析]]

ICA 是解决BSS问题最主流的方法。它的核心假设是：**原始声源信号是相互统计独立的**。

ICA通过优化一个**代价函数 (Cost Function)** 来寻找最优的解混矩阵 $\mathbf{W}(f)$，这个代价函数用来衡量输出信号 $\hat{\mathbf{S}}(f, t)$ 的**非高斯性 (Non-Gaussianity)** 或**独立性**。

**中心极限定理**告诉我们，多个独立随机变量的混合趋向于高斯分布。反过来，如果我们让分离后的信号**尽可能地非高斯**，就可能使它们恢复到独立的原始状态。

### 基于峭度 (Kurtosis) 的代价函数

峭度是衡量分布"尖峰"程度的四阶统计量。高斯分布的峭度为0。许多信号（如语音）都是超高斯分布（峭度>0）。我们可以通过最大化输出信号的峭度来分离它们。

### 算法流程

ICA通常采用迭代的方式求解。一个经典的频域ICA算法流程如下：

1.  **对每个频点 $f$ 初始化解混矩阵 $\mathbf{W}(f)$** (例如，初始化为单位矩阵)。
2.  **对每个时间帧 $t$ 进行迭代更新**:
    a. 计算当前分离后的信号: $\hat{\mathbf{S}}(f, t) = \mathbf{W}(f) \mathbf{X}(f, t)$。
    b. 计算一个非线性函数 $g(\cdot)$ 作用于分离信号，例如 $g(u) = \tanh(|u|)e^{j\cdot\text{angle}(u)}$。
    c. 根据梯度下降（或自然梯度）更新解混矩阵:
       $$\Delta \mathbf{W}(f) \propto \left[ \mathbf{I} - E\{ g(\hat{\mathbf{S}}(f, t)) \hat{\mathbf{S}}^H(f, t) \right] \mathbf{W}(f)$$
3.  **重复步骤2直到 $\mathbf{W}(f)$ 收敛**。

### 两个经典问题及其解决

频域ICA有两个著名的模糊性问题：

1.  **幅度模糊性 (Scaling Ambiguity)**: 无法确定分离出信号的真实幅度。即 $W(f)A(f)$ 是一个对角阵，但不一定是单位阵。
2.  **排列模糊性 (Permutation Ambiguity)**: 在每个频点 $f$ 单独进行分离，无法保证分离出的第一个源 $S_1(f, t)$ 在所有频点上都对应同一个物理声源。这会导致分离出的频谱混乱。

**解决方法**:
- **幅度模糊性**: 通常通过后处理，例如，将解混后的信号投影回原始混合信号空间来恢复合理的尺度。
- **排列模糊性**: 这是频域BSS的核心挑战。解决方法通常是基于**源模型的连续性**，例如，假设相邻频点或时间帧的混合矩阵/解混矩阵是平滑变化的，或者利用声源的DOA信息在不同频点间进行匹配。

## 3. 独立向量分析 (Independent Vector Analysis, IVA)

> 详见：[[BSS/04_IVA独立向量分析]]、[[BSS/05_AuxIVA辅助函数IVA]]

IVA 是对ICA的扩展，它能更好地解决排列问题。IVA不再假设每个频点的信号 $S_j(f, t)$ 独立，而是假设**每个声源是一个整体（一个向量）**，即 $\mathbf{s}_j = [S_j(f_1,t), S_j(f_2,t), \dots]^T$ 是独立的。

它通过一个联合的代价函数来建模多个频率分量之间的依赖关系，从而在分离过程中自动对齐不同频率的成分，避免了排列问题。

## 4. 深度学习方法

> 详见：[[BSS/07_DL_TasNet]]、[[BSS/08_DL_ConvTasNet]]、[[BSS/09_DL_DualPath]]、[[BSS/10_DL_SepFormer]]

近年来，深度学习方法在语音分离领域取得了显著进展：

| 方法 | 年份 | SI-SNRi (dB) | 特点 |
|------|------|--------------|------|
| TasNet | 2018 | ~10 | 首个时域端到端方法 |
| Conv-TasNet | 2019 | 15.3 | TCN替代LSTM |
| DPRNN | 2020 | 18.8 | 双路径处理长序列 |
| SepFormer | 2021 | 22.3 | Transformer架构 |

**总结**: BSS，特别是基于ICA/IVA的方法，为在未知环境下分离多个声源提供了强大的理论框架。它与波束形成（通常需要DOA等先验信息）构成了多通道信号处理的两个主要技术分支。深度学习方法则提供了数据驱动的强大分离能力。
