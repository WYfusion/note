[预印版](https://arxiv.org/abs/2109.00265)
# 1 研究背景与意义

多通道语音增强利用空间信息（多麦克风）在降噪/分离上具有天然优势，但传统做法通常把 DNN 的**掩码估计**与基于统计的**波束形成**（如 MVDR、MWF）***串联***，前者误差会放大后者效果，且两步并非端到端最优。
## 近年来有三条主线：
- 掩码+统计波束（tandem）
- 把空间信息与谱特征并入网络（neural spatial filter）
- 直接用 DNN 回归波束权重（all-neural beamformer）
本文采用的路线是第三条。目标是实现**因果、逐帧（frame-wise）且端到端可训练的全神经波束形成器**，便于实时部署并充分利用数据学习更高阶的时空统计特征。
### 意义
若成功，能在保留传统波束形成优势（空间滤波能力）的同时，摆脱显式协方差矩阵计算/求逆的不稳定性，获得更鲁棒、更高质量的语音恢复（论文在多个指标上超过了若干 SOTA 与 oracle-MVDR）。


# 2 研究框架与方法论（总体架构与关键模块）

论文提出 **EaBNet（Embedding and Beamforming Network）**
![[architecture.png|1000]]
### 三大模块
1. Embedding Module (EM)
2. Beamforming Module (BM)
3. PostNet（后处理）
它主要由两个模块组成，即 EM 和 BM。此外，还引入了后处理模块以进一步抑制残余噪声分量。不同的模块用不同的颜色标记，b图是各模块的架构细节。实现了**整体为逐帧、因果且端到端训练**。
## 核心流程
采样：16 kHz；STFT 320 pts；20 ms Hann；50% overlap。训练的各维度信息是$[B, C, F, T]$
1. 输入：多通道 STFT 的实/虚部按 channel 拼接，形成张量输入。
2. EM：输出三维 embedding 张量(变形了) $\tilde{E}\in\mathbb{C}^{F\times T\times C}$ ，在时频与通道维度上同时编码聚合 `频谱-空间` 信息。
	1. 结构为 U²-Encoder / [[时间卷积模块TCM#^dc0bb6|S-TCN]]（bottleneck）/ U²-Decoder，使用 4个堆叠的 `REL `/ `RDL`（包含 2D-(De)GLU、IN、PReLU、UNet-block 等）。
	2. encoder/decoder channel = 64；
	3. [[时间卷积模块TCM#^dc0bb6|S-TCN]]: 3 stacks × (6 S-TCM)，kernel=5，dilation={1,2,4,8,16,32}。
	4. [[门控线性单元GLU|2D-(De)GLU]]的2D因果卷积输出是两倍的输出通道，然后拆分为一部分的x和一部分的用于sigmoid的门控，其中的时间维度步长s=1,频率维度步长为2(下采样了)，核大小为(2，3)。
	5. [[IN(Instance Normalization)|IN]]是实例归一化层，
	6. REL / RDL 中的每一个都有完整的UNet-block，这里都是4个UNet-block形式串行，REL / RDL分别是4、3、2、1层(反)卷积的en和de构成的UNet-block，核大小分别是(2,5)、(2,3)×3；步长(1,2)×4。
3. BM：把 $\tilde{E}$ 映射为每帧、每频点、每麦克风的复数滤波权重 $\tilde{M}\in\mathbb{C}^{F\times T\times P}$ ，并执行 filter-and-sum 得到 $\tilde{S}^{(1)}$ 。实现方式有两种备选：
	1. C-BF：PW点卷积即(1，1)的卷积核把 embedding C→2P（实/虚）映射
	2. R-BF：先 LayerNorm，然后两层 uni-directional LSTM（每频独立共享权重），再 FC 输出滤波系数（逐帧更新）。论文发现 R-BF 在空间信息不可靠时更鲁棒，因此采用的是R-BF并非C-BF。
4. PostNet：单通道后处理用于抑制残余噪声，论文采用作者之前的 GaGNet（也可替换为任意轻量单通道 SE 模型）。

##### 重要设计理念与实现细节（可直接落地的要点）和理论贡献价值：
- **范式贡献**：先直接学习 embedding（隐式时空统计），而不是显式估计协方差矩阵；论文指出隐式 embedding 更紧凑、可能包含更高阶统计、更鲁棒于实际场景，再由网络直接回归帧级复数波束权重”的全神经、因果、端到端框架，证明其可超越传统 mask+统计波束与 oracle-MVDR。
- **方法论贡献**：EM 提出的 U²-Encoder/Decoder + S-TCN 结构用于捕捉多尺度谱和空间信息，体现“谱-空联合表征”的思路。BM 的 R-BF（subband LSTM）设计则将传统子带独立处理思想与 DNN 学习相结合。
- 因果与逐帧权重适合在线/实时系统（论文明确实现了因果版本并测量了实时因子）。

# 研究结果与讨论（实验设置、指标、定量结论）

### 数据与对比

- 数据：基于 DNS-Challenge 清洗集（~562 小时），合成多通道训练集约 80k 条训练样本、4k 验证。噪声库 ~55 小时，RIR 用 image method 生成 9-ch 线性阵列（间距 4 cm），$RT60 ∈ [0.05,0.7]$，源距取 {0.5,1,2,3} m，$SNR ∈ [−6,6]$ dB。测试噪声挑选 NOISE-X92 与 CHiME3 的 challening 噪声。
- train：
	- 16 kHz，20 ms Hann 窗，50% overlap，FFT采样点数320 → 频点 F=161。
	- 输入/目标采用幅值功率压缩$|X|^{0.5}e^{j\theta}$。
	- Loss：带有大小约束限制的MMSE。
	- 优化：Adam lr=5e-4（plateau 衰减），batch=8，epochs=60。
- 评价指标与比较
	- 指标：PESQ、ESTOI（%）、SDR（dB）。
	- 与 baselines（CTSNet、GaGNet、FasNet+TAC、MC-ConvTasNet、MIMO-UNet、oracle MB-MVDR）比较，EaBNet 在平均（四个 SNR）上取得显著提升。
		- EaBNet（带 PostNet）Avg PESQ=3.63，ESTOI=87.06%，SDR=17.12 dB
		- MIMO-UNet Avg PESQ=2.65，ESTOI=68.23%，SDR=11.45 dB
		- oracle MB-MVDR Avg PESQ=3.10，ESTOI=83.57%，SDR=14.26 dB。
### 论文结论
1. 引入 UNet-block（保持多尺度谱信息与空间信息）能显著提升性能（消融表明有明显增益）。
2. 直接估计参考通道 mask（即单通道输出）显著劣于波束化操作，强调多通道波束形成的重要性。
3. R-BF（LSTM）比 C-BF（卷积）在某些配置下更好，因为 LSTM 可逐帧维护状态并更稳定地估计帧级权重。
4. 幅度压缩（power compression）提升 PESQ / ESTOI，但对 SDR 有轻微负面影响（压缩更利于低能量区噪声抑制，但可能带来目标失真）。
5. EaBNet 在参数量上相对轻量（2.84M 参数，RTF=0.59，在 Intel i5-4300 单核 1.9GHz 上）仍满足实时要求，加入 PostNet 后性能进一步提升但计算量增加。