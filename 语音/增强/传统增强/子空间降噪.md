![[Pasted image 20250915112931.png|300]]
### 去噪过程：
噪声信号 $y = x+n$，在时域上 $x$ 和 $n$ 本来很难分开，但是经过 $P$ 的映射，将信号映射到 $P$ 域后，$y^p$，落在子空间 $A$ 上的部分就是信号即 $y^p$ 的**前 $M$ 个维度就是干净信号**。落在空间 $n$ 上的部分即后 $N-M$ 个维度即噪声部分。**将噪声部分清零**，再进行P域的反变换，就得到增强后的信号。
#### $P$ 域的正变换与反变换
正变换： $\mathbf{y}^{\mathbf{p}}=\mathbf{P}\mathbf{y}$ ，其中 $\mathbf{P\in(N,N)}\quad\mathbf{y\in(N,1)}$
反变换： $\mathbf{y}=\mathbf{P}^{-1}\mathbf{y}^\mathbf{p}=\mathbf{P}^\mathbf{T}\mathbf{y}^\mathbf{P}$ ，后一个等式仅当 $\mathbf{P}$ 为正交阵时成立
![[Pasted image 20250915113813.png|600]]
其中的子空间 $A$ 若是不为简单的 $0、1$ ，而是其他数值，比如变成 $(0,1)$ 之间的比例值，则可以形成类似维纳滤波和MMSE的效果
因此子空间法的本质就是找一个 $\mathbf{H}$ 使得含噪信号 $y$ 映射为干净的信号 $x$，注意 $\mathbf{H}=\mathbf{H^T}$
## 推导
#### 定义
接收信号： $\mathbf{y=x+n}$
估计信号： $\mathbf{\hat{x}=Hy}$
估计误差：$\varepsilon=\mathbf{\hat{x}-x}=(\mathbf{H-I)\cdot x+}\mathbf{H\cdot n}=\varepsilon_{\mathbf{x}}+\varepsilon_{\mathbf{n}}$ ，前者是语音损失，后者是噪声残留
语音损失能量： $\overline{\varepsilon_{\mathbf{x}}}^{2}=\mathrm{E}[\varepsilon_{\mathbf{x}}^{T}\varepsilon_{\mathbf{x}}]=\mathrm{tr}\left(\mathrm{E}[\varepsilon_{\mathbf{x}}\varepsilon_{\mathbf{x}}^{T}]\right)$ 
噪声残留能量： ${\overline{\varepsilon_{\mathrm{~n~}}^{2}}}=\mathrm{E}[\varepsilon_{\mathrm{~n~}}^{T}\varepsilon_{\mathrm{~n~}}]=tr\left(\mathrm{E}[\varepsilon_{\mathrm{~n~}}\varepsilon_{\mathrm{~n~}}^{T}]\right)$
#### 分析
可以将*语音损失*和*噪声残留*带入**语音损失能量**和**噪声残留能量**公式中得到：
语音损失能量： $\overline{\mathcal{E}_\mathrm{x}^2}=tr\left(\mathrm{HR}_\mathrm{x}\mathrm{H^T-HR}_\mathrm{x}\mathrm{-R}_\mathrm{x}\mathrm{H^T+R}_\mathrm{x}\right)$ 
噪声残留能量： $\overline{\boldsymbol{\varepsilon}_\mathrm{n}^2}\boldsymbol{=}tr\left(\mathbf{HR}_\mathrm{n}\mathbf{H}^\mathrm{T}\right)$
其中的 $\mathrm{R}_\mathrm{x}$ 和 $\mathrm{R}_\mathrm{n}$ 分别是期望信号的协方差矩阵和噪声干扰的协方差矩阵
#### 构建目标函数
求解 $\mathbf{H}$ 使得：$$\begin{aligned}\min _ { H } \overline { { { \varepsilon _ { x } ^ { 2 } } } }\\ \text { s.t. } \quad \frac { 1 } { N } \overline { { { \varepsilon _ { n } ^ { 2 } } } } < \delta ^ { 2 }\end{aligned}$$
其中的 $\mathbf{N}$ 是特征维度 $\delta ^ { 2 }$ 是容许的噪声冗余。
#### 求解
利用拉格朗日乘子法进行求解：$\mathrm{L(H,\mu)=tr(\mathrm{HR_x}\mathrm{H^T-H}\mathrm{R_x}-\mathrm{R_x}H^T+R_x)+\mu tr(\mathrm{HR_n}H^T-N\delta^2)}$
1. 对 $\mathbf{H}$ 求偏导等于0得：$\frac{\partial\mathbf{L}}{\partial\mathbf{H}}=0,\quad\mathbf{R_{x}} \mathbf{H^T}-\mathbf{R_x}+\mu \mathbf{R_n}\mathbf{H^T=0},\quad \mathbf{H=R_x(R_x+\mu R_n)^{-1}}$ ，这里用到了 $\mathbf{H}=\mathbf{H^T}$
2. 再对 $\mathbf{R_x}$ 进行特征值分解 $\mathbf{R_{x}}=\mathbf{U\Delta_{x}U^{T}}$ ，由于 $\mathbf{R_x}$ 是实对称矩阵，所以 $\mathbf{U}$ 是正交阵，即 $\mathbf{UU^{T}=I}$，$\mathbf{U^{-1}=U^T}$
3. 对 $\mathbf{H=R_x(R_x+\mu R_n)^{-1}}$ 变形为 $\mathbf{H=U\Delta_{x}U^{T}(U\Delta_{x}U^{T}+\mu UU^{T} R_n UU^{T})^{-1}}$ ，注意相乘矩阵的逆计算法则需要变换相乘顺序的，于是有 $\mathbf{H_{opt}=U\Delta_{x}\left(\Delta_{\mathbf{x}}+\mu U^{T}R_{\mathbf{n}}U\right)^{-1}U^{T}}$ ，其中的 $\mathbf{U^{T}R_{\mathbf{n}}U}$ 部分不为对角阵，因为一般不是高斯白噪声的情况。
##### 构建 $\mathbf{U^{T}R_{\mathbf{n}}U}$ 为对角阵的更加普适形式
1. 只需要保障 $\begin{aligned}\mathbf{V^T}\mathbf{R_x}\mathbf{V}&=\Lambda_\mathbf{x}\\\mathbf{V^T}\mathbf{R_n}\mathbf{V}&=\mathbf{I}\end{aligned}$ 即可实现信号分量和噪声分量都是可以对角化。得到 $\Lambda_\mathbf{x}$ 和 $\mathbf{V}$ 分别是 $\mathbf{R^{-1}_n}\mathbf{R_x}$ 的特征值和特征向量，带入到 $\mathbf{H=R_x(R_x+\mu R_n)^{-1}}$ 得 $\begin{aligned}H_{opt}&=V^{-T}\Lambda_{\mathbf{x}}(\Lambda_{\mathbf{x}}+\mu I)^{-1}V^T\end{aligned}$
2. 取对角阵：$G=\Lambda_{\mathbf{x}}(\Lambda_{\mathbf{x}}+\mu I)^{-1}$，其中的对角线元素为：$g_{kk}=\begin{cases}\frac{\lambda_{\mathbf{x}}^{(k)}}{\lambda_{\mathbf{x}}^{(k)}+\mu},&k=1,2,\ldots,M\\0,&k=M+1,\ldots,&\end{cases}$，其中 $\mu=0$ 为谱减法， $\mu=1$ 为维纳滤波法。
3. 由于 $\mathbf{R^{-1}_n}\mathbf{R_x}$ 中的 $\mathbf{R_x}$ 不方便直接计算，所以假设 $R_\mathbf{y}=R_\mathbf{x}+R_\mathbf{n}$ ，即 $R_\mathbf{n}^{-1}R_\mathbf{x}=R_\mathbf{n}^{-1}(R_\mathbf{y}-R_\mathbf{n})=R_\mathbf{n}^{-1}R_\mathbf{y}-I$，所以需要对噪声进行协方差的估计
4. 其中的 $\mu$ 的估计 $\mu=\mu_0-\left(\mathbf{SNR_{dB}}\right)/s$ 
5. 计算 $\mathbf{H=V^{-T}GV^T}$ 
6. 进行增强 $\mathbf{x=Hy}$ 


