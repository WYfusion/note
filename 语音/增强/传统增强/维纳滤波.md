# Wiener Filter
就是设计一个滤波器，使得输入的含噪语音经过滤波器之后得到的输出的干净语音其与期望干净的语音之间的均方误差最小。
![[Pasted image 20250912153716.png|700]]
### 频率域分析
也有时域分析的方式，不过语音更适合于频域分析。
![[Pasted image 20250912153825.png|1000]]
注意，其中的斜体 $E(\omega)$ 代表的是噪声误差，正体 $\text{E}$ 代表的是求取期望值。
这里的求导，只需要将 $H(\omega_k)$ 视为一个函数即可，其与 $H^*(\omega_k)$ 是不一样的函数。
![[Pasted image 20250912154548.png|1000]]
物理意义解释：$\hat{X}(\omega)=H(\omega)*Y(\omega)$ 是输出的干净语音，其中的 $H(\omega)$ 由于信噪比很大，所以趋近于1，因此对于输入的信号抑制效果比较弱，也就是允许通过，经过的去噪的强度比较轻微。
先验信噪比的得知需要预先知道噪声与语音的具体情况，但是实际情况下是不知道的，因此需要进行估计先验信噪比 $H(\omega_k)=\frac{\xi_k}{\xi_k+1}$ ，这个也是**维纳滤波的基本公式**。


也有一些维纳滤波的变体
### 平方根维纳滤波
对维纳滤波器的基本公式使用开根号形式的维纳滤波器：$\hat{X}(\omega_\mathrm{k})=\sqrt{H(\omega_\mathrm{k})}*Y(\omega_\mathrm{k})$
作用推导：左右去平方求期望有：$\text{E}|\hat{X}(\omega_k)|^2=\left(\sqrt{H(\omega_k)}\right)^2*\text{E}\left(|Y(\omega_k)|^2\right)$ 即 $P_{\hat{x}\hat{x}}(\omega_k)=H(\omega_k)P_{yy}(\omega_k)$ ，然后带入上图右侧公式得 $H(\omega_k)=\frac{P_{yx}^*(\omega_k)}{P_{yy}(\omega_k)}=\frac{P_{xx}(\omega_k)}{P_{xx}(\omega_k)+P_{nn}(\omega_k)}$，也即有$P_{\hat{x}\hat{x}}(\omega_k)=P_{xx}(\omega_k)$ 
这样就可以发现：保证了增强后信号的能量谱与干净语音的**能量谱**相同
### 参数型维纳滤波器
对维纳滤波器的基本公式进行加入参数：$H(\omega_k)=\left(\frac{P_{xx}(\omega_k)}{P_{xx}(\omega_k)+\alpha P_{nn}(\omega_k)}\right)^\beta$
如果能够提前获取一些先验知识：噪声集中在那些频带等，可以灵活的设置参数，$\alpha$ 越大对输出的抑制越强烈，因此有在噪声大的频带选取较大的 $\alpha$ ，在噪声小的频带选取较小的$\alpha$
![[Pasted image 20250912191144.png|900]]
不同信噪比下的参数设计下维纳滤波器对输出的抑制程度。

### 使用场景
- 情况1：已知干净语音clean以及含噪语音noisy，求解滤波器H  
适用场景举例：在通信过程中，语音信号通过一个参数未知的噪声信道，在发送端加入一个约定好的已知信号  
（如，在有用信号的末尾）；在接收端，收取信号后，利用含噪的已知信号求解滤波器H，并利用其对其余信号进行滤波去噪。
- 情况2:干净语音未知的情况下，可以利用谱减法先进行噪声估计，再进行滤波。去噪的效果不太好，因为维纳滤波是以频率乘积的形式进行去噪，总会有不希望出现的频率成分得到保留。但是另一方面，他对于弱语音结构的保留情况就比谱减法好的多了。因此先谱减法噪声估计再用维纳滤波适合于追求严格保留语音结构的任务，当然这并不是说直接用谱减法就一定会造成语音的结构出现损伤(主要还是看信噪比了)
- 情况3:如果已知噪声的某些分布特性，可以通过人为向干净语音加噪声的方法获取一组训练数据，利用这些数据训练维纳滤波器H进行滤波


### 缺点
1. 当前的滤波器都是非因果的，无法很好的做到实时性
2. 噪声谱固定
3. 滤波器参数固定


