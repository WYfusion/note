# å»¶è¿Ÿæ±‚å’Œæ³¢æŸå½¢æˆ (Delay-and-Sum Beamforming)

## 1. åŸºæœ¬åŸç†

**å»¶è¿Ÿæ±‚å’Œ (Delay-and-Sum, DS)** æ˜¯æœ€ç®€å•ã€æœ€ç»å…¸çš„æ³¢æŸå½¢æˆæ–¹æ³•ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šé€šè¿‡å¯¹å„éº¦å…‹é£ä¿¡å·æ–½åŠ é€‚å½“çš„æ—¶å»¶ï¼Œä½¿ç›®æ ‡æ–¹å‘çš„ä¿¡å·åœ¨ç›¸ä½ä¸Šå¯¹é½ï¼Œç„¶åæ±‚å’Œä»¥å¢å¼ºç›®æ ‡ä¿¡å·ã€‚

### 1.1 ç‰©ç†ç›´è§‚

```
å£°æº (Î¸â‚€)
    â†“
   ğŸ”Š
  / | \
 /  |  \
ğŸ¤ ğŸ¤ ğŸ¤  â† ä¿¡å·åˆ°è¾¾æ—¶é—´ä¸åŒ
 â†“  â†“  â†“
[Ï„â‚ Ï„â‚‚ Ï„â‚ƒ] â† è¡¥å¿æ—¶å»¶
 â†“  â†“  â†“
 åŒç›¸å åŠ  â†’ å¢å¼º
```

**æ­¥éª¤**ï¼š
1. **å»¶è¿Ÿ (Delay)**ï¼šè¡¥å¿å„éº¦å…‹é£çš„ä¼ æ’­æ—¶å»¶å·®
2. **æ±‚å’Œ (Sum)**ï¼šå°†å¯¹é½åçš„ä¿¡å·ç›¸åŠ 

---

## 2. æ•°å­¦æ¨å¯¼

### 2.1 æ—¶åŸŸæ¨¡å‹

ç¬¬ $p$ ä¸ªéº¦å…‹é£æ¥æ”¶åˆ°çš„ä¿¡å·ï¼š
$$x_p(t) = s(t - \tau_p) + n_p(t)$$

å…¶ä¸­ $\tau_p$ æ˜¯å£°æ³¢ä»æºåˆ°ç¬¬ $p$ ä¸ªéº¦å…‹é£çš„ä¼ æ’­æ—¶å»¶ã€‚

**å»¶è¿Ÿè¡¥å¿**ï¼š
$$x_p(t + \tau_p) = s(t) + n_p(t + \tau_p)$$

**æ±‚å’Œ**ï¼š
$$y(t) = \frac{1}{P}\sum_{p=1}^{P} x_p(t + \tau_p)$$

$$y(t) = s(t) + \frac{1}{P}\sum_{p=1}^{P} n_p(t + \tau_p)$$

**ä¿¡å·å¢å¼º**ï¼š
- ä¿¡å·éƒ¨åˆ†ï¼š$P$ ä¸ªåŒç›¸ä¿¡å·ç›¸åŠ ï¼Œå¹…åº¦å¢åŠ  $P$ å€
- å™ªå£°éƒ¨åˆ†ï¼šå‡è®¾ä¸ç›¸å…³ï¼ŒåŠŸç‡å¢åŠ  $P$ å€ï¼Œå¹…åº¦å¢åŠ  $\sqrt{P}$ å€

**SNRæ”¹å–„**ï¼š
$$\text{SNR}_{\text{out}} = P \cdot \text{SNR}_{\text{in}}$$

$$\text{SNR}_{\text{gain}} = 10\log_{10}(P) \text{ dB}$$

### 2.2 é¢‘åŸŸæ¨¡å‹

é€šè¿‡STFTå˜æ¢åˆ°é¢‘åŸŸï¼š

$$X_p(f,t) = S(f,t) e^{-j2\pi f \tau_p} + N_p(f,t)$$

**ç›¸ä½è¡¥å¿**ï¼š
$$X_p(f,t) e^{j2\pi f \tau_p} = S(f,t) + N_p(f,t) e^{j2\pi f \tau_p}$$

**æ±‚å’Œ**ï¼š
$$Y(f,t) = \frac{1}{P}\sum_{p=1}^{P} X_p(f,t) e^{j2\pi f \tau_p}$$

### 2.3 å‘é‡å½¢å¼

å®šä¹‰å¯¼å‘çŸ¢é‡ï¼š
$$\mathbf{d}(\theta_0, f) = [e^{-j2\pi f \tau_1}, e^{-j2\pi f \tau_2}, \ldots, e^{-j2\pi f \tau_P}]^T$$

**DSæƒé‡**ï¼š
$$\mathbf{w}_{\text{DS}}(f) = \frac{1}{P}\mathbf{d}^*(\theta_0, f)$$

**è¾“å‡º**ï¼š
$$Y(f,t) = \mathbf{w}_{\text{DS}}^H(f) \mathbf{X}(f,t)$$

---

## 3. è¿œåœºè¿‘ä¼¼

### 3.1 å¹³é¢æ³¢å‡è®¾

å½“å£°æºè·ç¦» $r \gg D$ï¼ˆé˜µåˆ—å­”å¾„ï¼‰æ—¶ï¼Œå¯ä»¥å‡è®¾å¹³é¢æ³¢åˆ°è¾¾ã€‚

**æ—¶å»¶è®¡ç®—**ï¼ˆçº¿æ€§é˜µåˆ—ï¼‰ï¼š

ä»¥ç¬¬ä¸€ä¸ªéº¦å…‹é£ä¸ºå‚è€ƒï¼š
$$\tau_p = \frac{(p-1)d \sin\theta_0}{c}$$

å…¶ä¸­ï¼š
- $d$ï¼šéº¦å…‹é£é—´è·
- $\theta_0$ï¼šç›®æ ‡æ–¹å‘ï¼ˆç›¸å¯¹äºé˜µåˆ—æ³•çº¿ï¼‰
- $c$ï¼šå£°é€Ÿ

**å¯¼å‘çŸ¢é‡**ï¼š
$$d_p(\theta_0, f) = e^{-j2\pi f (p-1)d \sin\theta_0 / c} = e^{-j(p-1)kd\sin\theta_0}$$

å…¶ä¸­ $k = 2\pi f / c$ æ˜¯æ³¢æ•°ã€‚

### 3.2 è¿‘åœºæ¨¡å‹

å¯¹äºè¿‘åœºæºï¼Œéœ€è¦è€ƒè™‘çƒé¢æ³¢ï¼š

$$\tau_p = \frac{\|\mathbf{r}_s - \mathbf{r}_p\| - \|\mathbf{r}_s - \mathbf{r}_{\text{ref}}\|}{c}$$

å…¶ä¸­ï¼š
- $\mathbf{r}_s$ï¼šå£°æºä½ç½®
- $\mathbf{r}_p$ï¼šç¬¬ $p$ ä¸ªéº¦å…‹é£ä½ç½®
- $\mathbf{r}_{\text{ref}}$ï¼šå‚è€ƒéº¦å…‹é£ä½ç½®

---

## 4. æ³¢æŸå›¾åˆ†æ

### 4.1 æ³¢æŸå›¾æ¨å¯¼

å¯¹äºå‡åŒ€çº¿æ€§é˜µåˆ—ï¼Œç›®æ ‡æ–¹å‘ $\theta_0 = 0$ï¼š

$$\mathbf{w} = \frac{1}{P}[1, 1, \ldots, 1]^T$$

æ³¢æŸå›¾ï¼š
$$B(\theta) = \mathbf{w}^H \mathbf{d}(\theta) = \frac{1}{P}\sum_{p=1}^{P} e^{-j(p-1)kd\sin\theta}$$

è¿™æ˜¯ä¸€ä¸ªå‡ ä½•çº§æ•°ï¼š
$$B(\theta) = \frac{1}{P} \cdot \frac{1 - e^{-jPkd\sin\theta}}{1 - e^{-jkd\sin\theta}}$$

**å¹…åº¦**ï¼š
$$|B(\theta)| = \frac{1}{P}\left|\frac{\sin(Pkd\sin\theta/2)}{\sin(kd\sin\theta/2)}\right|$$

### 4.2 ä¸»ç“£å®½åº¦

**ç¬¬ä¸€é›¶ç‚¹ä½ç½®**ï¼š

ä»¤åˆ†å­ä¸ºé›¶ï¼š
$$Pkd\sin\theta/2 = \pi$$

$$\sin\theta = \frac{\lambda}{Pd} = \frac{\lambda}{D}$$

å¯¹äºå°è§’åº¦ï¼ˆ$\theta \ll 1$ï¼‰ï¼š
$$\theta_{\text{null}} \approx \frac{\lambda}{D}$$

**3dBå¸¦å®½**ï¼š

$$\Delta\theta_{3dB} \approx 0.886 \frac{\lambda}{D}$$

**è§‚å¯Ÿ**ï¼š
- ä¸»ç“£å®½åº¦ä¸é˜µåˆ—å­”å¾„ $D$ æˆåæ¯”
- ä¸»ç“£å®½åº¦ä¸æ³¢é•¿ $\lambda$ï¼ˆé¢‘ç‡çš„å€’æ•°ï¼‰æˆæ­£æ¯”
- é¢‘ç‡è¶Šé«˜ï¼Œä¸»ç“£è¶Šçª„ï¼ŒæŒ‡å‘æ€§è¶Šå¼º

### 4.3 æ—ç“£ç‰¹æ€§

**ç¬¬ä¸€æ—ç“£ä½ç½®**ï¼š

$$Pkd\sin\theta/2 = 3\pi/2$$

**ç¬¬ä¸€æ—ç“£ç”µå¹³**ï¼š

$$SLL_1 = 20\log_{10}\left(\frac{2}{3\pi}\right) \approx -13.5 \text{ dB}$$

è¿™æ˜¯DSæ³¢æŸå½¢æˆçš„å›ºæœ‰ç‰¹æ€§ï¼Œä¸é˜µåˆ—å‚æ•°æ— å…³ã€‚

---

## 5. æ€§èƒ½åˆ†æ

### 5.1 ç™½å™ªå£°å¢ç›Š

å‡è®¾å™ªå£°åœ¨å„éº¦å…‹é£ä¸ç›¸å…³ï¼š

$$\mathbf{R}_N = \sigma_n^2 \mathbf{I}$$

ç™½å™ªå£°å¢ç›Šï¼š
$$WNG = \frac{|\mathbf{w}^H\mathbf{d}(\theta_0)|^2}{\mathbf{w}^H\mathbf{w}}$$

å¯¹äºDSï¼š
$$\mathbf{w} = \frac{1}{P}\mathbf{d}^*(\theta_0)$$

$$WNG = \frac{|P/P|^2}{(1/P^2) \cdot P} = P$$

$$WNG_{dB} = 10\log_{10}(P)$$

**ç»“è®º**ï¼š$P$ ä¸ªéº¦å…‹é£çš„DSæ³¢æŸå½¢æˆæœ‰ $10\log_{10}(P)$ dBçš„ç™½å™ªå£°å¢ç›Šã€‚

**ç¤ºä¾‹**ï¼š
- 2éº¦å…‹é£ï¼š3 dB
- 4éº¦å…‹é£ï¼š6 dB
- 8éº¦å…‹é£ï¼š9 dB

### 5.2 æŒ‡å‘æ€§å› å­

å¯¹äºçº¿æ€§é˜µåˆ—ï¼š

$$DF = \frac{|\mathbf{w}^H\mathbf{d}(\theta_0)|^2}{\frac{1}{2\pi}\int_{-\pi}^{\pi} |\mathbf{w}^H\mathbf{d}(\theta)|^2 d\theta}$$

**è¿‘ä¼¼å…¬å¼**ï¼ˆ$kD \gg 1$ï¼‰ï¼š

$$DF \approx \frac{2D}{\lambda} = \frac{2Df}{c}$$

$$DI = 10\log_{10}(DF) \approx 10\log_{10}\left(\frac{2Df}{c}\right)$$

**è§‚å¯Ÿ**ï¼š
- æŒ‡å‘æ€§å› å­ä¸é¢‘ç‡æˆæ­£æ¯”
- ä½é¢‘æ—¶æŒ‡å‘æ€§å·®
- é«˜é¢‘æ—¶æŒ‡å‘æ€§å¼º

### 5.3 é˜µåˆ—å¢ç›Š

å¯¹äºç©ºé—´ç™½å™ªå£°ï¼š
$$AG = WNG = P$$

å¯¹äºæ‰©æ•£å™ªå£°åœºï¼š
$$AG = DF \approx \frac{2D}{\lambda}$$

**é¢‘ç‡ä¾èµ–æ€§**ï¼š
- ä½é¢‘ï¼š$DF < P$ï¼Œæ‰©æ•£å™ªå£°æŠ‘åˆ¶å·®
- é«˜é¢‘ï¼š$DF > P$ï¼Œæ‰©æ•£å™ªå£°æŠ‘åˆ¶å¥½

---

## 6. å®ç°æ–¹æ³•

### 6.1 æ—¶åŸŸå®ç°

**æ­¥éª¤**ï¼š
1. è®¡ç®—å„éº¦å…‹é£çš„æ—¶å»¶ $\tau_p$
2. å¯¹ä¿¡å·è¿›è¡Œå»¶è¿Ÿï¼ˆæ’å€¼ï¼‰
3. æ±‚å’Œå¹¶å½’ä¸€åŒ–

```python
def delay_and_sum_time(signals, delays, fs):
    """
    æ—¶åŸŸå»¶è¿Ÿæ±‚å’Œæ³¢æŸå½¢æˆ
    
    å‚æ•°:
        signals: [P, T] - Pä¸ªéº¦å…‹é£ï¼ŒTä¸ªé‡‡æ ·ç‚¹
        delays: [P] - å„éº¦å…‹é£çš„å»¶è¿Ÿï¼ˆç§’ï¼‰
        fs: é‡‡æ ·ç‡
    """
    P, T = signals.shape
    output = np.zeros(T)
    
    for p in range(P):
        # è®¡ç®—å»¶è¿Ÿçš„é‡‡æ ·ç‚¹æ•°
        delay_samples = delays[p] * fs
        
        # åˆ†æ•°å»¶è¿Ÿæ’å€¼
        delayed = fractional_delay(signals[p], delay_samples)
        output += delayed
    
    return output / P

def fractional_delay(signal, delay):
    """åˆ†æ•°å»¶è¿Ÿå®ç°ï¼ˆä½¿ç”¨sincæ’å€¼ï¼‰"""
    # ç®€åŒ–å®ç°ï¼šä½¿ç”¨scipy.signal.resampleæˆ–FFTç›¸ç§»
    pass
```

### 6.2 é¢‘åŸŸå®ç°

**æ­¥éª¤**ï¼š
1. STFTå˜æ¢åˆ°é¢‘åŸŸ
2. å¯¹æ¯ä¸ªé¢‘ç‚¹åº”ç”¨ç›¸ä½è¡¥å¿
3. æ±‚å’Œ
4. iSTFTå˜æ¢å›æ—¶åŸŸ

```python
def delay_and_sum_freq(X, d_vec, theta0, f, c=343):
    """
    é¢‘åŸŸå»¶è¿Ÿæ±‚å’Œæ³¢æŸå½¢æˆ
    
    å‚æ•°:
        X: [P, F, T] - é¢‘åŸŸä¿¡å·
        d_vec: [P] - éº¦å…‹é£ä½ç½®ï¼ˆç›¸å¯¹äºå‚è€ƒç‚¹ï¼‰
        theta0: ç›®æ ‡æ–¹å‘ï¼ˆå¼§åº¦ï¼‰
        f: [F] - é¢‘ç‡æ•°ç»„
        c: å£°é€Ÿ
    """
    P, F, T = X.shape
    Y = np.zeros((F, T), dtype=complex)
    
    for fi in range(F):
        # è®¡ç®—å¯¼å‘çŸ¢é‡
        k = 2 * np.pi * f[fi] / c
        steering = np.exp(-1j * k * d_vec * np.sin(theta0))
        
        # å»¶è¿Ÿæ±‚å’Œ
        w = steering.conj() / P
        Y[fi, :] = w @ X[:, fi, :]
    
    return Y
```

### 6.3 å­å¸¦å®ç°

åœ¨å­å¸¦åŸŸè¿›è¡Œå¤„ç†ï¼Œå¹³è¡¡è®¡ç®—å¤æ‚åº¦å’Œå»¶è¿Ÿã€‚

---

## 7. ä¼˜ç¼ºç‚¹åˆ†æ

### 7.1 ä¼˜ç‚¹

1. **ç®€å•ç›´è§‚**ï¼šåŸç†æ¸…æ™°ï¼Œæ˜“äºç†è§£å’Œå®ç°
2. **é²æ£’æ€§å¥½**ï¼šå¯¹é˜µåˆ—è¯¯å·®å’Œç¯å¢ƒå˜åŒ–ä¸æ•æ„Ÿ
3. **æ— éœ€ç»Ÿè®¡ä¿¡æ¯**ï¼šä¸éœ€è¦å™ªå£°åæ–¹å·®çŸ©é˜µ
4. **è®¡ç®—é‡å°**ï¼šåªéœ€ç®€å•çš„å»¶è¿Ÿå’Œæ±‚å’Œ
5. **ç™½å™ªå£°å¢ç›Šé«˜**ï¼š$WNG = P$ï¼Œä¸ä¼šæ”¾å¤§ä¼ æ„Ÿå™¨å™ªå£°

### 7.2 ç¼ºç‚¹

1. **éè‡ªé€‚åº”**ï¼šæ— æ³•æ ¹æ®å™ªå£°ç¯å¢ƒè°ƒæ•´
2. **æ—ç“£å›ºå®š**ï¼šç¬¬ä¸€æ—ç“£çº¦-13.5 dBï¼Œæ— æ³•é™ä½
3. **ä½é¢‘æ€§èƒ½å·®**ï¼šæŒ‡å‘æ€§éšé¢‘ç‡é™ä½è€Œä¸‹é™
4. **éœ€è¦DOA**ï¼šå¿…é¡»çŸ¥é“ç›®æ ‡æ–¹å‘
5. **å¹²æ‰°æŠ‘åˆ¶å¼±**ï¼šå¯¹ç›¸å¹²å¹²æ‰°æŠ‘åˆ¶èƒ½åŠ›æœ‰é™

---

## 8. æ”¹è¿›æ–¹æ³•

### 8.1 åŠ æƒå»¶è¿Ÿæ±‚å’Œ

å¼•å…¥å¹…åº¦åŠ æƒä»¥é™ä½æ—ç“£ï¼š

$$\mathbf{w} = \frac{\mathbf{a} \odot \mathbf{d}^*(\theta_0)}{\mathbf{a}^T\mathbf{d}^*(\theta_0)}$$

å…¶ä¸­ $\mathbf{a}$ æ˜¯å¹…åº¦æƒé‡å‘é‡ï¼Œ$\odot$ æ˜¯é€å…ƒç´ ä¹˜æ³•ã€‚

**å¸¸ç”¨çª—å‡½æ•°**ï¼š
- Hammingçª—
- Hanningçª—
- Chebyshevçª—

**æ•ˆæœ**ï¼š
- é™ä½æ—ç“£ç”µå¹³
- ä¸»ç“£å˜å®½
- ç™½å™ªå£°å¢ç›Šé™ä½

### 8.2 é¢‘ç‡ä¾èµ–æƒé‡

å¯¹ä¸åŒé¢‘ç‡ä½¿ç”¨ä¸åŒçš„æƒé‡ï¼Œå®ç°é¢‘ç‡ä¸å˜æ³¢æŸå½¢æˆã€‚

### 8.3 è¿‘åœºèšç„¦

å¯¹äºè¿‘åœºæºï¼Œä½¿ç”¨çƒé¢æ³¢æ¨¡å‹è®¡ç®—æ—¶å»¶ã€‚

---

## 9. åº”ç”¨åœºæ™¯

### 9.1 ä¼šè®®ç³»ç»Ÿ

**é…ç½®**ï¼š
- çº¿æ€§é˜µåˆ—ï¼Œ4-8ä¸ªéº¦å…‹é£
- é—´è·ï¼š3-5 cm
- æŒ‡å‘ä¼šè®®æ¡Œ

**ä¼˜åŠ¿**ï¼š
- ç®€å•å¯é 
- ä½å»¶è¿Ÿ
- æˆæœ¬ä½

### 9.2 åŠ©å¬å™¨

**é…ç½®**ï¼š
- 2ä¸ªéº¦å…‹é£
- é—´è·ï¼š1-2 cm
- å‰å‘æŒ‡å‘

**ä¼˜åŠ¿**ï¼š
- è®¡ç®—é‡æå°
- åŠŸè€—ä½
- 3 dBå¢ç›Š

### 9.3 éº¦å…‹é£é˜µåˆ—æ¨¡å—

**é…ç½®**ï¼š
- åœ†å½¢æˆ–çº¿æ€§é˜µåˆ—
- 6-8ä¸ªéº¦å…‹é£
- å¯åˆ‡æ¢æ–¹å‘

**ä¼˜åŠ¿**ï¼š
- çµæ´»æ€§
- é²æ£’æ€§
- æ˜“äºé›†æˆ

---

## 10. æ•°å€¼ç¤ºä¾‹

### 10.1 4å…ƒçº¿æ€§é˜µåˆ—

**å‚æ•°**ï¼š
- $P = 4$
- $d = 0.05$ m
- $f = 2000$ Hz
- $\theta_0 = 0Â°$

**è®¡ç®—**ï¼š

æ³¢æ•°ï¼š$k = 2\pi f / c = 36.6$ rad/m

ä¸»ç“£å®½åº¦ï¼š
$$\theta_{\text{null}} = \arcsin\left(\frac{c}{fPd}\right) = \arcsin\left(\frac{343}{2000 \times 4 \times 0.05}\right) \approx 31Â°$$

ç™½å™ªå£°å¢ç›Šï¼š
$$WNG = 10\log_{10}(4) = 6 \text{ dB}$$

æŒ‡å‘æ€§å› å­ï¼š
$$DF \approx \frac{2 \times 0.15 \times 2000}{343} \approx 1.75$$
$$DI \approx 2.4 \text{ dB}$$

### 10.2 å®Œæ•´Pythonå®ç°

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import stft, istft

class DelayAndSumBeamformer:
    def __init__(self, mic_positions, fs, c=343):
        """
        å‚æ•°:
            mic_positions: [P, 3] - éº¦å…‹é£ä½ç½®åæ ‡
            fs: é‡‡æ ·ç‡
            c: å£°é€Ÿ
        """
        self.mic_pos = np.array(mic_positions)
        self.P = len(mic_positions)
        self.fs = fs
        self.c = c
        
    def steer(self, theta, phi=0):
        """
        è®¡ç®—å¯¼å‘çŸ¢é‡
        
        å‚æ•°:
            theta: æ–¹ä½è§’ï¼ˆå¼§åº¦ï¼‰
            phi: ä¿¯ä»°è§’ï¼ˆå¼§åº¦ï¼‰
        """
        # æ–¹å‘å•ä½å‘é‡
        u = np.array([
            np.cos(phi) * np.sin(theta),
            np.cos(phi) * np.cos(theta),
            np.sin(phi)
        ])
        
        # è®¡ç®—æ—¶å»¶
        ref_pos = self.mic_pos[0]
        delays = -np.dot(self.mic_pos - ref_pos, u) / self.c
        
        return delays
    
    def process_freq(self, X, theta, phi=0):
        """
        é¢‘åŸŸå¤„ç†
        
        å‚æ•°:
            X: [P, F, T] - é¢‘åŸŸä¿¡å·
            theta, phi: ç›®æ ‡æ–¹å‘
        """
        P, F, T = X.shape
        
        # è®¡ç®—æ—¶å»¶
        delays = self.steer(theta, phi)
        
        # é¢‘ç‡æ•°ç»„
        freqs = np.fft.rfftfreq(2*(F-1), 1/self.fs)
        
        # åº”ç”¨å»¶è¿Ÿæ±‚å’Œ
        Y = np.zeros((F, T), dtype=complex)
        for fi, f in enumerate(freqs):
            # ç›¸ä½è¡¥å¿
            phase_shift = np.exp(1j * 2 * np.pi * f * delays)
            w = phase_shift.conj() / P
            Y[fi, :] = w @ X[:, fi, :]
        
        return Y
    
    def process(self, signals, theta, phi=0):
        """
        å®Œæ•´å¤„ç†æµç¨‹
        
        å‚æ•°:
            signals: [P, T] - æ—¶åŸŸä¿¡å·
            theta, phi: ç›®æ ‡æ–¹å‘
        """
        # STFT
        f, t, X = stft(signals, fs=self.fs, nperseg=512)
        
        # å»¶è¿Ÿæ±‚å’Œ
        Y = self.process_freq(X, theta, phi)
        
        # iSTFT
        _, y = istft(Y, fs=self.fs, nperseg=512)
        
        return y

# ä½¿ç”¨ç¤ºä¾‹
mic_pos = np.array([[0, 0, 0], [0.05, 0, 0], 
                    [0.10, 0, 0], [0.15, 0, 0]])
bf = DelayAndSumBeamformer(mic_pos, fs=16000)

# å¤„ç†ä¿¡å·
# signals = ... # [4, T]
# output = bf.process(signals, theta=0)
```
