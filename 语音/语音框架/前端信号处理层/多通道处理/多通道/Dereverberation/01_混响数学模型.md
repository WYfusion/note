# 混响数学模型

## 1. 概述

**混响 (Reverberation)** 是声音在封闭空间中经过多次反射形成的声学现象。理解混响的数学模型是去混响算法设计的基础。

### 1.1 物理过程

```
声源 🔊
  ↓
直达声 ────────────→ 🎤 麦克风
  ↓
反射声 ─→ 墙壁 ─→ 🎤
  ↓
多次反射 ─→ ─→ ─→ 🎤
```

**时间轴**：
```
|────|──────────|─────────────────────→
直达声  早期反射      后期混响
0ms   0-50ms        50ms+
```

---

## 2. 房间冲激响应 (RIR)

### 2.1 定义

**房间冲激响应 (Room Impulse Response, RIR)** 是房间对冲激信号的响应，完整描述了房间的声学特性。

**数学表示**：

$$h(t) = h_d(t) + h_e(t) + h_l(t)$$

其中：
- $h_d(t)$：直达声
- $h_e(t)$：早期反射（0-50ms）
- $h_l(t)$：后期混响（>50ms）

### 2.2 时域模型

**卷积模型**：

$$y(t) = x(t) * h(t) + n(t)$$

$$= \int_{-\infty}^{\infty} x(\tau)h(t-\tau)d\tau + n(t)$$

其中：
- $x(t)$：源信号（干净语音）
- $h(t)$：房间冲激响应
- $y(t)$：混响语音
- $n(t)$：加性噪声

**离散形式**：

$$y[n] = \sum_{k=0}^{L-1} h[k]x[n-k] + n[n]$$

其中 $L$ 是RIR长度。

### 2.3 频域模型

**频域表示**：

$$Y(f) = H(f)X(f) + N(f)$$

其中：
- $Y(f) = \mathcal{F}\{y(t)\}$：混响语音频谱
- $H(f) = \mathcal{F}\{h(t)\}$：房间传输函数
- $X(f) = \mathcal{F}\{x(t)\}$：干净语音频谱

**短时傅里叶变换 (STFT)**：

$$Y(f, t) = H(f)X(f, t) + N(f, t)$$

这是去混响算法最常用的表示形式。
